<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Royalty Charts</title>

  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#1aa3ff" />

  <!-- Icons are optional; app works without them -->
  <link rel="icon" href="icons/icon-192.svg" />

  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div id="app" class="app">
    <header class="topbar">
      <div class="brand">
        <span class="brand-glow"></span>
        <div>
          <h1>Royalty Charts</h1>
          <p class="subtitle">Offline-first Trading Journal</p>
        </div>
      </div>
      <div class="topbar-actions">
        <button id="installBtn" class="btn btn-outline hidden">Install</button>
        <button id="backToJournals" class="btn btn-outline hidden">Journals</button>
      </div>
    </header>

    <main>
      <!-- JOURNAL SELECTOR -->
      <section id="journalSelector" class="screen active">
        <div class="card">
          <h2>Journals</h2>
          <p class="muted">
            Create separate journals for each account. Data stays on this device.
          </p>

          <!-- ONE empty state only -->
          <p id="journalEmptyState" class="muted">
            No journals yet. Create your first journal.
          </p>

          <div id="journalList" class="journal-list"></div>

          <div class="journal-actions">
            <input
              id="newJournalName"
              type="text"
              placeholder="Journal name"
            />
            <button id="createJournalBtn" class="btn btn-primary">
              Create Journal
            </button>
          </div>
        </div>
      </section>

      <!-- JOURNAL APP -->
      <section id="journalApp" class="screen">
        <nav class="tabs">
          <button data-tab="calendar" class="tab active">Calendar</button>
          <button data-tab="add" class="tab">Add Trade</button>
          <button data-tab="trades" class="tab">Trades</button>
          <button data-tab="analytics" class="tab">Analytics</button>
          <button data-tab="settings" class="tab">Settings</button>
        </nav>

        <!-- CALENDAR -->
        <section id="calendar" class="tab-panel active">
          <div class="calendar-header">
            <button id="prevMonth" class="btn btn-outline">◀</button>
            <div>
              <h2 id="calendarLabel"></h2>
              <p class="muted">Tap a day for details</p>
            </div>
            <button id="nextMonth" class="btn btn-outline">▶</button>
          </div>

          <div id="calendarGrid" class="calendar-grid"></div>
          <div id="dayDetail" class="card hidden"></div>
        </section>

        <!-- ADD TRADE -->
        <section id="add" class="tab-panel">
          <form id="tradeForm" class="card form">
            <h2>Add Trade</h2>

            <div class="form-grid">
              <label>Instrument <input name="instrument" type="text" /></label>

              <label>
                Market Type
                <select name="marketType">
                  <option value="Forex">Forex</option>
                  <option value="Synthetic">Synthetic</option>
                </select>
              </label>

              <label>
                Direction
                <select name="direction">
                  <option value="Buy">Buy</option>
                  <option value="Sell">Sell</option>
                </select>
              </label>

              <label>Date/Time <input name="dateTime" type="datetime-local" /></label>
              <label>Session
                <select name="session">
                  <option value="Asia">Asia</option>
                  <option value="London">London</option>
                  <option value="New York">New York</option>
                  <option value="Custom">Custom</option>
                </select>
              </label>

              <label>Entry <input name="entryPrice" type="number" step="0.0001" /></label>
              <label>Stop Loss <input name="stopLoss" type="number" step="0.0001" /></label>
              <label>Take Profit <input name="takeProfit" type="number" step="0.0001" /></label>
              <label>Exit <input name="exitPrice" type="number" step="0.0001" /></label>
              <label>Lot Size <input name="lotSize" type="number" step="0.01" /></label>

              <label>Balance <input name="balance" type="number" /></label>
              <label>Risk % <input name="riskPercent" type="number" /></label>
              <label>Risk Amount <input name="riskAmount" type="number" readonly /></label>

              <label>P/L ($) <input name="plUsd" type="number" /></label>
              <label>P/L (₦) <input name="plNgn" type="number" /></label>
              <label>Pips <input name="pips" type="number" /></label>

              <label>Status
                <select name="status">
                  <option value="Open">Open</option>
                  <option value="Closed">Closed</option>
                </select>
              </label>

              <label>Close Date/Time <input name="closeDateTime" type="datetime-local" /></label>
            </div>

            <label>Notes <textarea name="notes"></textarea></label>

            <div class="card subtle">
              <h3>Confluence Checklist</h3>
              <div id="confluenceChecklist"></div>
            </div>

            <div class="card subtle">
              <h3>Screenshots</h3>
              <input id="screenshotInput" type="file" accept="image/*" multiple />
              <div id="screenshotPreview" class="screenshot-grid"></div>
            </div>

            <div class="card subtle">
              <h3>Risk Guidance</h3>
              <p id="riskGuidance" class="muted"></p>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Save Trade</button>
              <button type="button" id="resetTradeForm" class="btn btn-outline">Reset</button>
            </div>
          </form>
        </section>

        <!-- TRADES -->
        <section id="trades" class="tab-panel">
          <div class="card">
            <h2>Trades</h2>
            <div class="trades-controls">
              <input id="tradeSearch" type="search" placeholder="Search" />
              <select id="tradeSort"></select>
            </div>
            <div id="tradeList"></div>
          </div>
        </section>

        <!-- ANALYTICS -->
        <section id="analytics" class="tab-panel">
          <div class="card">
            <h2>Analytics</h2>
            <div id="analyticsStats" class="stats-grid"></div>
            <canvas id="equityChart"></canvas>
            <canvas id="dailyChart"></canvas>
            <div id="confluenceStats"></div>
          </div>
        </section>

        <!-- SETTINGS -->
        <section id="settings" class="tab-panel">
          <div class="card">
            <h2>Journal Settings</h2>

            <label>
              Journal Name
              <input id="journalNameInput" type="text" />
            </label>

            <button id="renameJournal" class="btn btn-outline">Rename</button>
            <button id="deleteJournal" class="btn btn-danger">Delete Journal</button>

            <div class="card subtle">
              <h3>Confluence Template</h3>
              <div id="templateEditor"></div>
              <input id="newTemplateItem" type="text" />
              <button id="addTemplateItem" class="btn btn-primary">Add</button>
            </div>

            <div class="card subtle">
              <h3>Instrument Values</h3>
              <div id="instrumentValues"></div>
              <input id="instrumentName" type="text" />
              <input id="instrumentValue" type="number" />
              <select id="instrumentType">
                <option value="Forex">Forex</option>
                <option value="Synthetic">Synthetic</option>
              </select>
              <button id="addInstrumentValue" class="btn btn-primary">Save</button>
            </div>

            <div class="card subtle">
              <h3>Import / Export</h3>
              <button id="exportJson">Export JSON</button>
              <button id="exportCsv">Export CSV</button>
              <input id="importJson" type="file" />
            </div>
          </div>
        </section>
      </section>
    </main>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>
